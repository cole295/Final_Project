---
title: "Gov 50 Final Project"
author: Cole Cochrane
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

I am interested in exploring data related to the impact on the standard of living from the level of social safety net spending. As the United States sees bigger calls for increased healthcare, social security and other spending on social safety net programs, it would be intriguing to explore the degree to which standards of living are affected by such investments.

Another idea I had in mind for my research is to explore the effects unionization has on the workplace. This includes quality of work, compensation and benefits, turnover rate, etc. etc. We have seen an increasing number of strikes and union-related activities, and it would be interesting to see the benefits from unionization.

## Finding data and writing a proposal

Does the level of healthcare spending in a country affect public health? In this study, I plan on examining the amount in which countries spend on healthcare as a percentage of their GDP, and to then compare their respective life expectancy. I hypothesize that the greater the percentage of GDP is spent on healthcare, the life expectancy would be higher. I expect that as there is greater spending on healthcare, there are larger investments in healthcare infrastructure and more funding for healthcare operations, which would  mean increased services for patients. Consequently, as patients enjoy a higher quality healthcare through larger investments, health problems would decline and would subsequently be reflected in life expectancy. My sample includes measures of healthcare spending from all countries between the years 2000 and 2020, as well as an additional sample on life expectancy by country in the same time period. The explanatory variable of interest is healthcare spending as a percentage of GDP, by country. If the variable were to be coded = 5.76, this means that 5.76% of GDP is spent on healthcare services. This variable is measured from the World Bank's data set on global healthcare expenditures by country. The outcome variable is life expectancy, which if it were to be coded = 65, then the average individual in the given country would live 65 years. This variable is measured by the World Health Organization's data set on life expectancy by country, 1960-2020. If I observe higher life expectancy as the percentage spent on healthcare increases, then it would support my hypothesis. If I observe lower life expectancy as the percentage spent on healthcare decreases, then it would not support my hypothesis. Furthermore, it would also not support my hypothesis if there were to be no relationship between the two variables. When I run my regression on the countries' healthcare spending and life expectancy, and I receive a positive, significant coefficient, then this would indicate support for my hypothesis.  

## Data visualization

```{r}
install.packages("readxl", repos = "http://cran.us.r-project.org")
library("readxl")
GHED <- read_excel("GHED_data.xlsx")
GLE <- read.csv("global life expectancy dataset.csv")
```

```{r}
library(dplyr)
library(tidyverse)

# rename categories in GLE
names(GLE) <- sub('^X', '', names(GLE))
colnames(GLE)[1] = "country"
colnames(GLE)[2] = "code"


# pivot GLE longer to have a life expectancy column
GLE <- GLE |>
  pivot_longer(
    cols = `2000`:`2020`,
    names_to = "year",
    values_to = "lifeExp"
  )

GLE <- GLE |>
  mutate(year = as.numeric(year))

# Removing columns 1960-1999
GLE <- GLE[, -3:-42]
  
  
# Merging datasets
merged_df <- GHED |>
  left_join(GLE, by = c("code", "year"))

# Eliminating unnecessary data
merged_df <- merged_df[,-36:-3221]
```

```{r}
# Data visualization: Creating a scatter plot of country's health expenditures and life expectancy in 2000. 

library(tidyverse)
library(ggplot2)
CHE_LifeExp <- merged_df |>
  filter(merged_df$year == '2000') |>
  ggplot(mapping = aes(x = log(che_pc_usd), y = lifeExp)) + 
  geom_point(aes(color = income)) +
  geom_smooth(method = "lm") +
  labs(x = "Healthcare Spending per capita (USD$)", y = "Life Expectancy (years)", title = "Does healthcare spending affect life expectancy? (2000)")
CHE_LifeExp
```

## Initial Analysis

When answering the question of how healthcare spending may affect life expectancy, I started by first observing the relationship between healthcare spending per capita in USD and life expectancy in years. After creating a visualization, it was difficult to describe a linear relationship and consequently scaled the healthcare spending per capita to a natural logarithm. It initially seemed pretty clear that there was a positive association: as healthcare spending per capita increased, so did life expectancy. I tested the strength of this relationship by calculating the correlation coefficient (r-value):

```{r}
# Calculating the correlation coefficient (r-value)
CHE_rvalue <- cor(merged_df$year, merged_df$che_pc_usd, use = "complete.obs")
CHE_rvalue
# Calculating the determination coefficient (square of r-value)
(CHE_rvalue)^2
```
R values closer to 1 would mean more data points fall upon the fitted line, while a value closer to 0 would show less correlation. Although this in itself demonstrates weak correlation, the coefficient of determination (square of the r-value) may be more indicative. 
The determination coefficient means that a percentage variation in the y variable can be explained by the x variable. In this context, 2.6% of the variation in life expectancy can be explained by the current level of healthcare spending per capita. This demonstrates a weak correlation between healthcare spending and life expectancy. Furthermore, there is a potentially confounding variable: the level of income. The scatter plot was color coded by the level of income each country has (e.g, low, high, etc.) and it can be distinctly observed that each income group was naturally formed into tight clumps respect to healthcare spending (e.g, high income countries were closely grouped on the higher end of spending). This does not take into account the value of the dollar in each country. In order to mitigate this potential confounder, I changed the measurement of healthcare spending from per capita in USD to percentage of GDP, which made the following graph:

```{r}
library(tidyverse)
`CHE(GDP)_LifeExp` <- merged_df |>
  filter(merged_df$year == '2000') |>
  ggplot(mapping = aes(x = che_gdp, y = lifeExp)) + 
  geom_point(aes(color = income)) +
  geom_smooth(method = "lm") +
  labs(x = "Healthcare Spending as % of GDP", y = "Life Expectancy (years)", title = "Does healthcare spending affect life expectancy? (2000)")
`CHE(GDP)_LifeExp`
```

## Further Analysis
It is noticeably different, with most countries regardless of income having roughly similar percentages of GDP dedicated to healthcare spending. First, it is helpful to compute the new coefficient of correlation:

```{r}
# Calculating the correlation coefficient
GDP_rvalue <- cor(merged_df$year, merged_df$che_gdp, use = "complete.obs")
GDP_rvalue

# Calculating the determination coefficient
(GDP_rvalue)^2
```
We observe that the correlation coefficient has decreased by approximately 0.047, or a 29% decrease compared to the previous coefficient. We also notice that when we square this value, we find that the coefficient of determination is roughly 0.013. This is a marked decrease from the previous value; now, only 1.3% of variation in life expectancy can be explained by healthcare spending as a % of GDP. Admittedly, this model is not entirely perfect for determining the relationship between healthcare spending and life expectancy. Instead of measuring healthcare spending as a percentage of GDP, it may be more sensible to measure it adjusted accordingly to purchasing power parity (PPP). In that case, the value of the dollar may have an effect on healthcare spending, and may change the strength of the relationship. However, at the current point in this research, it appears that there is a very weak correlation between healthcare spending and life expectancy, and it would be worth exploring other contributing factors to life expectancy.






































































































































